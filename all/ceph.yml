---
##########################
# docker

docker_registry: quay.io

##########################
# generic

containerized_deployment: true
fetch_directory: /share
generate_fsid: false
ntp_service_enabled: false
dashboard_enabled: false

# NOTE(berendt): We use an adapted Ceph image in which always the UID 64045 is used
ceph_uid: 64045
bootstrap_dirs_owner: "64045"
bootstrap_dirs_group: "64045"

##########################
# osd

osd_objectstore: bluestore
osd_scenario: lvm

##########################
# group names

client_group_name: ceph-client
grafana_server_group_name: ceph-grafana-server
iscsi_gw_group_name: ceph-iscsigw
mds_group_name: ceph-mds
mgr_group_name: ceph-mgr
mon_group_name: ceph-mon
nfs_group_name: ceph-nfs
osd_group_name: ceph-osd
rbdmirror_group_name: ceph-rbdmirror
restapi_group_name: ceph-restapi
rgw_group_name: ceph-rgw

##########################
# grafana

dashboard_admin_password:
grafana_admin_password:

##########################
# manager

ceph_mgr_modules:
  - balancer
  - dashboard
  - prometheus
  - status

##########################
# rgw

radosgw_frontend_port: 8081

##########################
# openstack

openstack_config: true

openstack_pool_default_size: 3
openstack_pool_default_min_size: 0
openstack_pool_default_pg_num: 64

openstack_cinder_backup_pool:
  name: "backups"
  pg_num: "{{ openstack_pool_default_pg_num }}"
  pgp_num: "{{ openstack_pool_default_pg_num }}"
  rule_name: "replicated_rule"
  type: 1
  erasure_profile: ""
  expected_num_objects: ""
  application: "rbd"
  size: "{{ openstack_pool_default_size }}"
  min_size: "{{ openstack_pool_default_min_size }}"
  pg_autoscale_mode: false

openstack_cinder_pool:
  name: "volumes"
  pg_num: "{{ openstack_pool_default_pg_num }}"
  pgp_num: "{{ openstack_pool_default_pg_num }}"
  rule_name: "replicated_rule"
  type: 1
  erasure_profile: ""
  expected_num_objects: ""
  application: "rbd"
  size: "{{ openstack_pool_default_size }}"
  min_size: "{{ openstack_pool_default_min_size }}"
  pg_autoscale_mode: false

openstack_glance_pool:
  name: "images"
  pg_num: "{{ openstack_pool_default_pg_num }}"
  pgp_num: "{{ openstack_pool_default_pg_num }}"
  rule_name: "replicated_rule"
  type: 1
  erasure_profile: ""
  expected_num_objects: ""
  application: "rbd"
  size: "{{ openstack_pool_default_size }}"
  min_size: "{{ openstack_pool_default_min_size }}"
  pg_autoscale_mode: false

openstack_gnocchi_pool:
  name: "metrics"
  pg_num: "{{ openstack_pool_default_pg_num }}"
  pgp_num: "{{ openstack_pool_default_pg_num }}"
  rule_name: "replicated_rule"
  type: 1
  erasure_profile: ""
  expected_num_objects: ""
  application: "rbd"
  size: "{{ openstack_pool_default_size }}"
  min_size: "{{ openstack_pool_default_min_size }}"
  pg_autoscale_mode: false

openstack_nova_pool:
  name: "vms"
  pg_num: "{{ openstack_pool_default_pg_num }}"
  pgp_num: "{{ openstack_pool_default_pg_num }}"
  rule_name: "replicated_rule"
  type: 1
  erasure_profile: ""
  expected_num_objects: ""
  application: "rbd"
  size: "{{ openstack_pool_default_size }}"
  min_size: "{{ openstack_pool_default_min_size }}"
  pg_autoscale_mode: false

openstack_pools:
  - "{{ openstack_cinder_backup_pool }}"
  - "{{ openstack_cinder_pool }}"
  - "{{ openstack_glance_pool }}"
  - "{{ openstack_gnocchi_pool }}"
  - "{{ openstack_nova_pool }}"

openstack_keys:
  - name: client.cinder-backup
    caps:
      mon: "profile rbd"
      osd: "profile rbd pool={{ openstack_cinder_backup_pool.name }}"
    mode: "0600"
  - name: client.cinder
    caps:
      mon: "profile rbd"
      osd: "profile rbd pool={{ openstack_cinder_pool.name }}, profile rbd pool={{ openstack_nova_pool.name }}, profile rbd pool={{ openstack_glance_pool.name }}"
    mode: "0600"
  - name: client.glance
    caps:
      mon: "profile rbd"
      osd: "profile rbd pool={{ openstack_cinder_pool.name }}, profile rbd pool={{ openstack_glance_pool.name }}"
    mode: "0600"
  - name: client.gnocchi
    caps:
      mon: "profile rbd"
      osd: "profile rbd pool={{ openstack_gnocchi_pool.name }}"
    mode: "0600"
  - name: client.nova
    caps:
      mon: "profile rbd"
      osd: "profile rbd pool={{ openstack_glance_pool.name }}, profile rbd pool={{ openstack_nova_pool.name }}, profile rbd pool={{ openstack_cinder_pool.name }}, profile rbd pool={{ openstack_cinder_backup_pool.name }}"
    mode: "0600"
